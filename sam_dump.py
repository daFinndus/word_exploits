import os

# Path to the directory containing the uploads
current_dir = os.path.dirname(os.path.realpath(__file__))

# Find all files starting with the name "upload" in the current directory
upload_files = [f for f in os.listdir(current_dir) if f.startswith('upload')]

# Sort the uploads based on the timestamp in their name
sorted_uploads = sorted(upload_files)

# Execute the samdump2 command with the first upload
sys_export = sorted_uploads[0]
sam_export = sorted_uploads[1]

print(f'Bytelength of sys_export: {len(sys_export)}')
print(f'Bytelength of sam_export: {len(sam_export)}')

command = f'samdump2 {os.path.join(current_dir, sam_export)} {os.path.join(current_dir, sys_export)}'
os.system(command)

confirmation = input('Do you want to delete the two files? (y/n)')

if confirmation.lower() == 'y':
    # Afterwards delete the two files
    os.remove(os.path.join(current_dir, sys_export))
    os.remove(os.path.join(current_dir, sam_export))
    print('Files deleted!')
else:
    print('Files are being kept!')
